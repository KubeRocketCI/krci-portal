import z from "zod";
import { kubeObjectBaseSchema, kubeObjectMetadataSchema } from "../../../common/index.js";
import { vulnerabilitySeverityEnum, vulnerabilityReportSpecSchema } from "../VulnerabilityReport/schema.js";

export const clusterVulnerabilitySeverityEnum = vulnerabilitySeverityEnum;

export const clusterVulnerabilityReportSpecSchema = vulnerabilityReportSpecSchema.extend({
  os: z
    .object({
      family: z.string().optional(),
      name: z.string().optional(),
      eosl: z.boolean().optional(),
    })
    .optional(),
});

export const clusterVulnerabilityReportSchema = kubeObjectBaseSchema.extend({
  metadata: kubeObjectMetadataSchema,
  report: clusterVulnerabilityReportSpecSchema,
});
